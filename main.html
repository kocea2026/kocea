<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta id="viewport-meta" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬ì ê²½ë ¥í™•ì¸ì„œ (ìµœì¢… ìˆ˜ì •)</title>
<style>
    /* --- [1. ê¸°ë³¸ ë ˆì´ì•„ì›ƒ ì„¤ì •] --- */
    :root {
        --base-width: 210mm; /* A4 ë„ˆë¹„ */
        --base-height: 297mm; /* A4 ë†’ì´ */
        --nav-height: 80px;
        --content-bg: #555;
    }

    body {
        background-color: var(--content-bg);
        margin: 0; padding: 0;
        font-family: 'Malgun Gothic', 'Dotum', sans-serif;
        width: 100vw; height: 100vh;
        /* ê¸°ë³¸: ì¤‘ì•™ ì •ë ¬ & ìŠ¤í¬ë¡¤ ë°©ì§€ (PC/ëª¨ë°”ì¼ ì„¸ë¡œ) */
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        overflow: hidden;
        box-sizing: border-box;
    }

    /* --- [2. ìƒë‹¨ ë‚´ë¹„ê²Œì´ì…˜ ë°”] --- */
    .top-nav {
        width: 100%;
        height: var(--nav-height);
        display: flex; align-items: center; justify-content: center;
        background: transparent;
        pointer-events: none;
        flex-shrink: 0;
    }

    .nav-inner {
        width: 90%;
        height: 100%;
        padding: 15px 0;
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 12px;
        pointer-events: auto;
        box-sizing: border-box;
    }

    /* --- [ë²„íŠ¼ ìŠ¤íƒ€ì¼] --- */
    .nav-btn {
        padding: 0;
        font-size: 15px; font-weight: bold; color: white;
        width: 100%; height: 100%; max-height: 50px;
        align-self: center;
        border-radius: 12px; cursor: pointer;
        display: flex; align-items: center; justify-content: center; gap: 8px; white-space: nowrap;
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        transition: transform 0.1s ease, box-shadow 0.2s ease;
        text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }
    .nav-btn span { display: inline-block; }
    .nav-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
        border-color: rgba(255, 255, 255, 0.7);
    }
    .nav-btn:active { transform: scale(0.97); }

    .btn-orange { background: rgba(255, 140, 0, 0.4); } .btn-orange:hover { background: rgba(255, 140, 0, 0.6); }
    .btn-blue   { background: rgba(41, 128, 185, 0.4); } .btn-blue:hover { background: rgba(41, 128, 185, 0.6); }
    .btn-green  { background: rgba(39, 174, 96, 0.4); }  .btn-green:hover { background: rgba(39, 174, 96, 0.6); }
    .btn-pink   { background: rgba(255, 105, 180, 0.4); } .btn-pink:hover { background: rgba(255, 105, 180, 0.6); }
    .btn-red    { background: rgba(192, 57, 43, 0.4); }    .btn-red:hover { background: rgba(192, 57, 43, 0.6); }

    /* --- [3. ê³„ì‚°ê¸° íŒ¨ë„] --- */
    .calc-panel {
        position: fixed; top: var(--nav-height); margin-top: 10px;
        left: 50%; transform: translateX(-50%); z-index: 9998;
        display: none; flex-direction: column; gap: 10px; padding: 15px 20px; width: 200px;
        background: rgba(255, 140, 0, 0.95); border: 1px solid rgba(255, 255, 255, 0.4);
        border-radius: 16px; backdrop-filter: blur(10px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3); color: white;
    }
    .calc-panel.show { display: flex; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateX(-50%) translateY(-10px); } to { opacity: 1; transform: translateX(-50%) translateY(0); } }

    .calc-toggle { position: absolute; right: -25px; top: 10px; width: 25px; height: 30px; background: rgba(255, 140, 0, 0.8); border-radius: 0 8px 8px 0; cursor: pointer; display: none; align-items: center; justify-content: center; font-size: 12px; color: white; }
    .calc-header { font-weight: bold; font-size: 11pt; border-bottom: 1px solid rgba(255,255,255,0.5); padding-bottom: 8px; margin-bottom: 5px; text-align: center; }
    .calc-row { display: flex; justify-content: space-between; align-items: center; }
    .calc-label { font-size: 10pt; } .calc-value { font-weight: bold; font-size: 16pt; } .calc-unit { font-size: 10pt; margin-left: 2px; }

    /* --- [4. ë°˜ì‘í˜• ë˜í¼] --- */
    #responsive-wrapper {
        width: 794px; /* A4 ê¸°ì¤€ ë„ˆë¹„ ê³ ì • */
        height: auto;
        display: flex; flex-direction: column;
        transform-origin: top center;
        transition: transform 0.1s linear;
        background-color: transparent;
    }

    /* ì»¤ìŠ¤í…€ ì¤Œ ì ìš© ëŒ€ìƒ(ëª¨ë°”ì¼ ì„¸ë¡œì—ì„œë§Œ í™œì„±í™”) */
    #zoom-container {
        transform-origin: top center;
        will-change: transform;
    }

    /* ì¤Œ í™œì„±ì¼ ë•Œë§Œ ì œìŠ¤ì²˜ë¥¼ ìš°ë¦¬ê°€ ë°›ë„ë¡(ë¸Œë¼ìš°ì € ê¸°ë³¸ ì œìŠ¤ì²˜ ì°¨ë‹¨) */
    body.zoom-enabled #zoom-container {
        touch-action: none;
    }

    .page-container {
        background-color: white; width: 100%; height: var(--base-height); padding: 10mm 15mm;
        box-sizing: border-box; position: relative; display: flex; flex-direction: column;
        box-shadow: 0 0 15px rgba(0,0,0,0.5);
    }

    /* --- [5. í…Œì´ë¸” ë° ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼] --- */
    table { width: 100%; border-collapse: collapse; margin: 0; table-layout: fixed; }
    th, td { border: 1px solid #000; padding: 1px 3px; vertical-align: middle; word-break: keep-all; font-size: 8.5pt; height: 24px; color: #000; }
    .no-side-outer tr th:first-child, .no-side-outer tr td:first-child { border-left: none !important; }
    .no-side-outer tr th:last-child, .no-side-outer tr td:last-child { border-right: none !important; }
    th { background-color: #e6e6e6; text-align: center; font-weight: normal; letter-spacing: -0.5px; }
    .border-top-thick { border-top: 2px solid #000 !important; }
    .border-bottom-thick { border-bottom: 2px solid #000 !important; }

    input, textarea, select {
        width: 100%; height: 100%; border: none; padding: 0; margin: 0;
        font-family: inherit; font-size: 8.5pt;
        background-color: transparent; outline: none; box-sizing: border-box;
        vertical-align: middle; color: #000; -webkit-appearance: none; border-radius: 0;
    }
    select {
        padding-right: 15px;
        background: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 10 10'%3E%3Cpath d='M0 0 L5 5 L10 0' fill='none' stroke='%23000' stroke-width='1.5'/%3E%3C/svg%3E") no-repeat right 2px center;
        background-size: 8px;
    }
    input:focus, textarea:focus, select:focus { background-color: #e8f0fe; }
    input:disabled, select:disabled { background-color: #f0f0f0; color: #aaa; cursor: not-allowed; }

    .required-missing { border: 2px solid #ff3333 !important; background-color: rgba(255, 51, 51, 0.05) !important; border-radius: 3px; }
    .center-text { text-align: center; }
    .left-text { text-align: left !important; padding-left: 5px; }
    .long-label { font-size: 7pt; letter-spacing: -0.8px; line-height: 1.1; }
    .nowrap-text { white-space: nowrap; }

    input[type="date"] { position: relative; text-align: center; color: transparent; padding: 0; cursor: pointer; }
    input[type="date"]::-webkit-datetime-edit { color: transparent; }
    input[type="date"]:focus, input[type="date"]:valid { color: #000; }
    input[type="date"]:focus::-webkit-datetime-edit, input[type="date"]:valid::-webkit-datetime-edit { color: #000; }
    input[type="date"]::-webkit-calendar-picker-indicator {
        position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; cursor: pointer;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23555555'%3E%3Cpath d='M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z'/%3E%3C/svg%3E");
        background-position: center; background-repeat: no-repeat; background-size: contain; width: 14px; height: 14px; opacity: 0.7; margin-left: 2px;
    }
    input[type="date"]:valid::-webkit-calendar-picker-indicator { background-image: none !important; opacity: 0; }

    /* --- [íˆ´íŒ ìŠ¤íƒ€ì¼] --- */
    .tooltip-container { position: relative; }
    .custom-tooltip {
        position: absolute; z-index: 1000; pointer-events: none; opacity: 0; transition: opacity 0.3s ease;
        top: 100%; left: 0; width: 100%; box-sizing: border-box; margin-top: 2px;
        padding: 6px 8px; border-radius: 4px; font-size: 8.5pt; font-weight: bold; white-space: normal; line-height: 1.4;
        background-color: #222; color: white; border: 2px solid transparent;
        background-image: linear-gradient(#222, #222), linear-gradient(135deg, #ff00cc, #3333ff, #00ccff);
        background-origin: border-box; background-clip: padding-box, border-box;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }
    .custom-tooltip.show { opacity: 1; }

    .footer-wrapper { margin-top: auto; display: flex; flex-direction: column; justify-content: flex-end; }
    .working-check-label { display: inline-flex; align-items: center; cursor: pointer; margin-left: 5px; font-size: 9pt; }
    .working-check-label input {
        appearance: none; -webkit-appearance: none; width: 14px; height: 14px;
        background-color: #fff; border: 1px solid #000; margin-right: 4px; position: relative;
        cursor: pointer; border-radius: 0;
    }
    .working-check-label input:checked::after {
        content: 'âœ”'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        font-size: 12px; color: black; font-weight: bold; line-height: 1;
    }

    /* --- [6. Mobile & Landscape êµ¬ë¶„ ìŠ¤íƒ€ì¼] --- */
    body.mobile-mode .calc-panel { top: 65px; width: 90%; }
    body.mobile-mode .calc-toggle { display: flex; }

    /* [Case 1 ì „ìš©] ëª¨ë°”ì¼ ê°€ë¡œ ëª¨ë“œ (Landscape) */
    @media screen and (orientation: landscape) and (max-height: 600px) {
        .top-nav { height: 50px; }
        .nav-inner { width: 98vw; padding: 5px 0; gap: 8px; margin: 0 auto; }
        .nav-btn { flex-direction: row; font-size: 11px; height: 40px; gap: 5px; }
    }

    /* --- [7. ì¸ì‡„ ëª¨ë“œ ì„¤ì •] --- */
    @media print {
        @page { size: A4; margin: 0; }
        body { background: white; padding: 0; margin: 0; height: 100%; overflow: visible; display: block; }
        .top-nav, .calc-panel, .custom-tooltip { display: none !important; }
        #responsive-wrapper { transform: none !important; width: 100% !important; height: auto !important; margin: 0 !important; box-shadow: none !important; }
        #zoom-container { transform: none !important; }
        .page-container { border: none; width: 100%; height: 297mm; padding: 10mm 15mm; }
        .footer-wrapper { margin-top: auto !important; }
        input, textarea, select { background: transparent !important; }
        .empty-value { color: transparent !important; }
        select { background-image: none; padding-right: 0; }
        input[type="date"] { color: transparent; } input[type="date"]:valid { color: #000; }
        input[type="date"]::-webkit-calendar-picker-indicator { display: none !important; }
        .required-missing { border: none !important; background-color: transparent !important; }
        .working-check-label { display: none !important; }
        ::placeholder { color: transparent !important; }
    }

    /* --- [8. ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ (í”ë“¤ë¦¼)] --- */
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
    }
    .shake-effect {
        animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        border: 2px solid #ff3333 !important;
}
   /* --- [9. í¬ì»¤ìŠ¤ ì‹œê°í™” (ë¬´ë¹™ ê·¸ë¼ë””ì–¸íŠ¸)] --- */
    @keyframes gradientMove {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    .focus-ring-active {
        /* í…Œë‘ë¦¬ ì˜ì—­ í™•ë³´ (íˆ¬ëª…) */
        border: 2px solid transparent !important;
        border-radius: 3px;
        
        /* [í•µì‹¬] 2ì¤‘ ë°°ê²½: ì•ˆìª½ì€ í°ìƒ‰, ë°”ê¹¥ìª½ì€ ê·¸ë¼ë””ì–¸íŠ¸ */
        background-image: linear-gradient(#fff, #fff), 
                          linear-gradient(270deg, #ff00cc, #3333ff, #00ccff, #ff00cc);
        background-origin: border-box;
        background-clip: padding-box, border-box;
        
        /* ê·¸ë¼ë””ì–¸íŠ¸ í¬ê¸°ë¥¼ í‚¤ì›Œì„œ ì›€ì§ì´ëŠ” íš¨ê³¼ ì—°ì¶œ */
        background-size: 100% 100%, 400% 400%;
        
        /* ì• ë‹ˆë©”ì´ì…˜ ì‹¤í–‰ (3ì´ˆ ê°„ê²© ë¬´í•œ ë°˜ë³µ) */
        animation: gradientMove 3s ease infinite;
        
        /* ë ˆì´ì•„ì›ƒ ë³´ì •: í…Œë‘ë¦¬ë§Œí¼ ì¤„ì–´ë“œëŠ” ê²ƒ ë°©ì§€ ë° ê°•ì¡° */
        box-shadow: 0 0 10px rgba(51, 51, 255, 0.4);
        z-index: 10;
        position: relative;
 }
</style>
</head>
<body onload="initAllFields();" onresize="resizeForm()">

<input type="file" id="file_input" style="display:none" accept=".json" onchange="loadFromFile(this)">

<div class="calc-panel" id="calcPanel">
    <div class="calc-toggle" onclick="document.getElementById('calcPanel').classList.toggle('collapsed')">â—€</div>
    <div class="calc-header">ğŸ“… ì°¸ì—¬ê¸°ê°„ ìë™ ê³„ì‚°</div>
    <div class="calc-row">
        <span class="calc-label">ì—°ë²ˆ 1</span>
        <div><span id="panel_days_1" class="calc-value">0</span><span class="calc-unit">ì¼</span></div>
    </div>
    <div class="calc-row">
        <span class="calc-label">ì—°ë²ˆ 2</span>
        <div><span id="panel_days_2" class="calc-value">0</span><span class="calc-unit">ì¼</span></div>
    </div>
</div>

<div id="responsive-wrapper">
    <!-- â˜… ì»¤ìŠ¤í…€ ì¤Œ/íŒ¬ ì ìš© ë ˆì´ì–´ -->
    <div id="zoom-container">
        <nav class="top-nav">
            <div class="nav-inner">
                <button class="nav-btn btn-orange" onclick="toggleCalcPanel()">
                    <span>ğŸ“…</span><span>ì°¸ì—¬ê¸°ê°„</span>
                </button>
                <button class="nav-btn btn-blue" onclick="saveToFile()">
                    <span>ğŸ’¾</span><span>ì €ì¥</span>
                </button>
                <button class="nav-btn btn-green" onclick="triggerFileLoad()">
                    <span>ğŸ“‚</span><span>ì—´ê¸°</span>
                </button>
                <button class="nav-btn btn-pink" onclick="validateAndPrint()">
                    <span>ğŸ–¨ï¸</span><span>ì¸ì‡„</span>
                </button>
                <button class="nav-btn btn-red" onclick="if(confirm('ë‚´ìš©ì„ ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) location.reload();">
                    <span>ğŸ”„</span><span>ì´ˆê¸°í™”</span>
                </button>
            </div>
        </nav>

        <div class="page-container">
            <div style="font-size: 8pt; margin-bottom: 15px; font-weight:bold;">
                â–  ê±´ì„¤ê¸°ìˆ  ì§„í¥ë²• ì‹œí–‰ê·œì¹™ [ë³„ì§€ ì œ12í˜¸ì„œì‹] &lt;ê°œì • 2024. 4. 23.&gt;
            </div>
            <div style="position: relative; height: 60px; margin-bottom: 20px;">
                <h1 style="position: absolute; width: 100%; top: 60%; transform: translateY(-50%); text-align: center; font-size: 20pt; letter-spacing: 5px; margin: 0; padding-right: 150px; box-sizing: border-box;">ê²½ë ¥í™•ì¸ì„œ</h1>
                <table style="width: 180px; position: absolute; top: -20px; right: 0; border: 2px solid black; height: 40px;">
                    <colgroup><col style="width: 40%"><col style="width: 40%"><col style="width: 40%"></colgroup>
                    <tr><th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">êµ¬ë¶„</th><th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ì¸ì‚¬ë¶€ì„œ</th><th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ì‚¬ì—…ë¶€ì„œ</th></tr>
                    <tr><th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ë¶€ì„œëª…</th><td style="height:7px;"></td> <td style="height:7px;"></td></tr>
                    <tr><th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ë‹´ë‹¹ì</th><td style="text-align:right; vertical-align:bottom; font-size:7pt; padding:0 2px; height:7px;">(ì¸)</td><td style="text-align:right; vertical-align:bottom; font-size:7pt; padding:0 2px; height:7px;">(ì¸)</td></tr>
                    <tr><th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ì—°ë½ì²˜</th><td style="height:7px;"></td> <td style="height:7px;"></td></tr>
                    <tr><th style="background:#fff; font-size:7pt; padding:2px 0; height:7px;">ë°œê¸‰ë²ˆí˜¸</th><td colspan="2" style="height:7px;"></td></tr>
                </table>
            </div>

            <table class="border-top-thick no-side-outer" style="margin-bottom: 10px;">
                <colgroup><col style="width: 10%;"> <col style="width: 10%;"> <col style="width: 20%;"> <col style="width: 12%;"> <col style="width: 18%;"> <col style="width: 13%;"> <col style="width: 17%;"></colgroup>
                <tr><th rowspan="2">ì¸ì <br>ì‚¬í•­</th><th>â‘  ì„± ëª…</th><td><div style="display:flex; justify-content:space-between; align-items:center;"><input type="text" id="user_name" style="width:60%;"><span class="nowrap-text" style="font-size:7pt; color:#888;">(ì„œëª… ë˜ëŠ” ì¸)</span></div></td><th>ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</th><td><input type="text" id="user_id" class="center-text" oninput="formatNumber(this, 'id')"></td><th class="long-label">íœ´ëŒ€ì „í™”ë²ˆí˜¸<br>(ì „í™”ë²ˆí˜¸)</th><td><input type="tel" id="user_phone" class="center-text" oninput="formatCompPhone(this)" maxlength="12"></td></tr>
                <tr><th>â‘¡ ì£¼ ì†Œ</th><td colspan="3"><input type="text" id="user_addr" oninput="autoFitText(this)"></td><th>ì „ììš°í¸ì£¼ì†Œ</th><td><input type="email" id="user_email"></td></tr>
            </table>

            <table class="no-side-outer">
                <colgroup><col style="width: 10%;"> <col style="width: 10%;"> <col style="width: 20%;"> <col style="width: 12%;"> <col style="width: 18%;"> <col style="width: 13%;"> <col style="width: 17%;"></colgroup>
                <tr class="border-top-thick"><th rowspan="3">ì†Œì†<br>íšŒì‚¬</th><th colspan="2">â‘¢ íšŒì‚¬ëª… ë° ëŒ€í‘œì</th><td colspan="2"><input type="text" id="comp_name" oninput="autoFitText(this)"></td><th class="long-label" style="font-size:7pt;">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸<br>(ë²•ì¸ë“±ë¡ë²ˆí˜¸)</th><td><input type="text" id="comp_biz" class="center-text" oninput="formatNumber(this, 'biz')"></td></tr>
                <tr><th colspan="2">ì˜ì—…ì†Œ ì†Œì¬ì§€</th><td colspan="2"><input type="text" id="comp_addr" oninput="autoFitText(this)"></td><th class="long-label">â‘£ ê±´ì„¤ì—…ì¢…<br>(ë“±ë¡ë²ˆí˜¸)</th><td><input type="text" id="comp_sector"></td></tr>
                <tr><td colspan="4" style="padding:0; border-right:1px solid #000;"><div style="display:flex; height:100%; width:100%;"><div style="flex:1; border-right:1px solid #000; background:#e6e6e6; display:flex; align-items:center; justify-content:center; font-size:8.5pt;">â‘¤ ì…ì‚¬ì¼</div><div style="flex:1; border-right:1px solid #000; padding:0 2px;"><input type="date" id="join_date" required onchange="validateAllDates(1); validateAllDates(2);" onkeydown="return false;"></div><div style="flex:1; border-right:1px solid #000; background:#e6e6e6; display:flex; align-items:center; justify-content:center; font-size:8.5pt;">â‘¥ í‡´ì‚¬ì¼</div><div style="flex:1; padding:0 2px; display:flex; align-items:center; justify-content:center;"><input type="date" id="retire_date" required style="width: 100%;" onchange="validateAllDates(1); validateAllDates(2);" onkeydown="return false;"><div id="retire_text" style="display:none; width:100%; text-align:center; font-size:8.5pt;">ì¬ì§ì¤‘</div><label class="working-check-label" title="í˜„ì¬ ê·¼ë¬´ ì¤‘ì´ë©´ ì²´í¬í•˜ì„¸ìš”"><input type="checkbox" id="chk_working" onchange="toggleRetireDate()">ì¬ì§</label></div></div></td><th>ì „í™”ë²ˆí˜¸</th><td><input type="tel" id="comp_phone" class="center-text" oninput="formatCompPhone(this)" maxlength="12"></td></tr>
            </table>

            <div style="text-align:center; font-weight:bold; background:#eaeaea; border:1px solid #000; border-bottom:none; border-left:none; border-right:none; margin-top:5px; height:24px; line-height:24px; font-size:9pt;" class="border-top-thick">ê¸° ìˆ  ê²½ ë ¥</div>

            <table class="border-bottom-thick no-side-outer">
                <colgroup><col style="width: 4%;"> <col style="width: 24%;"> <col style="width: 24%;"> <col style="width: 24%;"> <col style="width: 24%;"></colgroup>
                <tr><th rowspan="5" class="border-bottom-thick">ì—°<br>ë²ˆ</th><th class="left-text">â‘¦ ì‚¬ì—…ê¸°ê°„(ì°©ê³µ~ì¤€ê³µ)</th><th colspan="3" class="left-text">â‘¨ ì°¸ì—¬ì‚¬ì—…ëª…</th></tr>
                <tr><th class="left-text">â‘§ ì°¸ì—¬ê¸°ê°„(ì‹œì‘~ì¢…ë£Œ)</th><th colspan="3" class="left-text">â‘© ë°œì£¼ì(ì²­)</th></tr>
                <tr><td colspan="4" style="padding:0; border:none;"><table style="width:100%; border:none;"><colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup><tr><th class="left-text" style="border-left:none; border-top:none;">â‘ª ê³µì‚¬ì¢…ë¥˜</th><th class="left-text" style="border-top:none;">â‘« ê³µì‚¬(ìš©ì—­)ê¸ˆì•¡(ë°±ë§Œì›)</th><th class="left-text" style="border-top:none;">â‘¬ ì§ë¬´ë¶„ì•¼</th><th class="left-text" style="border-top:none; border-right:none;">â‘­ ì „ë¬¸ë¶„ì•¼</th></tr></table></td></tr>
                <tr><td colspan="4" style="padding:0; border:none;"><table style="width:100%; border:none;"style="width:100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #ccc;"><colgroup><col style="width:50%;"><col style="width:18%;"><col style="width:7%;"><col style="width:25%;"></colgroup><tr><th class="left-text" style="border-left:none; border-top:none;">â‘® ê³µì‚¬(ìš©ì—­)ê°œìš”(150ì ì´ë‚´ ë¹ˆì¹¸ í¬í•¨)</th><th class="left-text" style="border-top:none;">â‘¯ ë‹´ë‹¹ì—…ë¬´</th><th class="left-text" style="border-top:none; font-size: 6.5pt; letter-spacing: -0.5px; padding: 0; line-height: 24px; text-align:center; white-space:nowrap;">â‘° ì±…ì„ì •ë„</th><th class="left-text" style="border-top:none; border-right:none;">â‘± ì§ìœ„</th></tr></table></td></tr>
                <tr><td colspan="4" style="padding:0; border:none;"><table style="width:100%; border:none;"><colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup><tr><th class="left-text" style="border-left:none; border-top:none; border-bottom:1px solid black;">â‘² ì ìš© ê³µë²•</th><th class="left-text" style="border-top:none; border-bottom:1px solid black;">â‘³ ì ìš© ìœµã†ë³µí•©ê±´ì„¤ê¸°ìˆ </th><th class="left-text" style="border-top:none; border-bottom:1px solid black;">ã‰‘ ì ìš© ì‹ ê¸°ìˆ  ë“±</th><th class="left-text" style="border-top:none; border-bottom:1px solid black; border-right:none;">ã‰’ ì‹œì„¤ë¬¼ ì¢…ë¥˜</th></tr></table></td></tr>

                <tr><th rowspan="5" class="border-bottom-thick" style="background:#fff;">1</th><td style="background-color: #f0f0f0 !important; cursor: not-allowed;"></td><td colspan="3" class="tooltip-container"><input type="text" id="proj_name_1" class="left-text e1-req" placeholder="â€» í´ë¦­í•˜ì—¬ ì˜ˆì‹œë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”!" onfocus="showTooltip(this)" onblur="hideTooltip(this)" oninput="checkEntry1(); checkHeadquarters(1)"><div class="custom-tooltip" id="tooltip_proj_name_1">(ì˜ˆì‹œ) 00ì•„íŒŒíŠ¸ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ê±´ë¬¼ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ë¹Œë”© ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ëŒ€í•™êµ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬</div></td></tr>
                <tr><td><div style="display:flex;"><input type="date" id="part_start_1" required class="e1-req" style="width:48%;" onkeydown="return false;" onchange="validateAllDates(1)" oninput="checkEntry1()">~<input type="date" id="part_end_1" required class="e1-req" style="width:48%;" onkeydown="return false;" onchange="validateAllDates(1)" oninput="checkEntry1()"></div></td><td colspan="3" style="cursor: not-allowed;"><input type="text" class="left-text" disabled style="cursor: not-allowed;"></td></tr>
                <tr><td colspan="4" style="padding:0; border:none;"><table style="width:100%; border:none;"><colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup><tr><td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none;"><input type="text" class="left-text" id="amt_1" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none; text-align: center;">ê¸°ê³„</td><td style="border-top:none; border-right:none; padding-left: 0;"><select id="spec1" class="left-text e1-req" onchange="checkSelectPlaceholder(this); checkEntry1();"><option value="">ì„ íƒ</option></select></td></tr></table></td></tr>
                <tr><td colspan="4" style="padding:0; border:none;"><table style="width:100%; border:none;"><colgroup><col style="width:50%;"><col style="width:18%;"><col style="width:7%;"><col style="width:25%;"></colgroup><tr><td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none;"><select id="task1" class="left-text e1-req" style="font-size: 8pt;" onchange="updateResponsibility(1); checkEntry1(); checkSelectPlaceholder(this);"><option value="">ì„ íƒ</option></select></td><td style="border-top:none; padding-right: 0;"><input type="text" id="resp1" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none; border-right:none; padding-left: 0;"><input type="text" id="pos_1" class="left-text e1-req" oninput="checkEntry1()"></td></tr></table></td></tr>
                <tr><td colspan="4" style="padding:0; border:none;"><table style="width:100%; border:none;"><colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup><tr><td style="border-left:none; border-top:none; border-bottom:2px solid black;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none; border-bottom:2px solid black;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none; border-bottom:2px solid black;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none; border-bottom:2px solid black; border-right:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td></tr></table></td></tr>

                <tr class="entry2-row"><th rowspan="5" style="background:#fff;">2</th><td style="background-color: #f0f0f0 !important; cursor: not-allowed;"></td><td colspan="3" class="tooltip-container e2-all"><input type="text" id="proj_name_2" class="left-text e2-req e2-all" placeholder="â€» í´ë¦­í•˜ì—¬ ì˜ˆì‹œë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”!" onfocus="showTooltip(this)" onblur="hideTooltip(this)" oninput="checkHeadquarters(2); checkEntry2();" disabled><div class="custom-tooltip e2-all" id="tooltip_proj_name_2" style="display: none;">(ì˜ˆì‹œ) 00ì•„íŒŒíŠ¸ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ê±´ë¬¼ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ë¹Œë”© ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬, 00ëŒ€í•™êµ ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬</div></td></tr>
                <tr class="entry2-row"><td><div style="display:flex;"><input type="date" id="part_start_2" required class="e2-req e2-all" style="width:48%;" onkeydown="return false;" onchange="validateAllDates(2); checkEntry2();" disabled>~<input type="date" id="part_end_2" required class="e2-req e2-all" style="width:48%;" onkeydown="return false;" onchange="validateAllDates(2); checkEntry2();" disabled></div></td><td colspan="3" style="cursor: not-allowed;"><input type="text" class="left-text" disabled style="cursor: not-allowed;"></td></tr>
                <tr class="entry2-row"><td colspan="4" style="padding:0; border:none;"><table style="width:100%; border:none;"><colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup><tr><td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none; text-align: center;">ê¸°ê³„</td><td style="border-top:none; border-right:none; padding-left: 0;"><select id="spec2" class="left-text e2-req e2-all" onchange="checkSelectPlaceholder(this); checkEntry1(); checkEntry2();" disabled><option value="">ì§ë¬´ë¶„ì•¼ ì„ íƒ í•„ìš”</option></select></td></tr></table></td></tr>
                <tr class="entry2-row"><td colspan="4" style="padding:0; border:none;"><table style="width:100%; border:none;"><colgroup><col style="width:50%;"><col style="width:18%;"><col style="width:7%;"><col style="width:25%;"></colgroup><tr><td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none;"><select id="task2" class="left-text e2-req e2-all" style="font-size: 8pt;" onchange="updateResponsibility(2); checkSelectPlaceholder(this); checkEntry2();" disabled><option value="">ì„ íƒ</option></select></td><td style="border-top:none; padding-right: 0;"><input type="text" id="resp2" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none; border-right:none; padding-left: 0;"><input type="text" id="pos_2" class="left-text e2-req e2-all" oninput="checkEntry2()" disabled></td></tr></table></td></tr>
                <tr class="entry2-row"><td colspan="4" style="padding:0; border:none;"><table style="width:100%; border:none;"><colgroup><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"><col style="width:25%;"></colgroup><tr><td style="border-left:none; border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td><td style="border-top:none; border-right:none;"><input type="text" class="left-text" disabled title="ìœ ì§€ê´€ë¦¬ìëŠ” í•´ë‹¹ ì‚¬í•­ ì—†ìŠµë‹ˆë‹¤."></td></tr></table></td></tr>
            </table>

            <div class="footer-wrapper">
                <div style="margin-top: 10px; display:flex; justify-content:space-between; align-items:flex-end;">
                    <span style="font-size: 10pt; margin-left:5px;">ìœ„ì™€ ê°™ì´ ê±´ì„¤ê¸°ìˆ ì¸ì˜ ê²½ë ¥ì„ í™•ì¸í•©ë‹ˆë‹¤.</span>
                    <span style="font-size: 10pt; margin-right:5px;"><input type="tel" style="width:40px; text-align:right;" placeholder="202X">ë…„ <input type="tel" style="width:30px; text-align:right;" placeholder="00">ì›” <input type="tel" style="width:30px; text-align:right;" placeholder="00">ì¼</span>
                </div>
                <div style="position:relative; width:100%; height:50px; text-align:center; margin-top:20px;">
                    <span style="font-size: 16pt; font-weight: bold; letter-spacing: -1px;">ë°œì£¼ì, ì¸ã†í—ˆê°€ê¸°ê´€ ë˜ëŠ” ì‚¬ìš©ì(ëŒ€í‘œì)</span>
                    <div style="position:absolute; right:80px; top:-10px; width:50px; height:50px; display:flex; align-items:center; justify-content:center; color:red; font-weight:bold; border:2px solid red; font-size:10pt;">ì§ì¸</div>
                </div>

                <div style="margin-top: 5px;">
                    <table style="border: 1px solid #000; border-top: 2px solid #000; width:100%; border-bottom: none;">
                        <tr><th style="background-color:#ccc; height:20px; border-bottom:3px solid #000; font-size:9pt; border-left:none; border-right:none;">ìœ ì˜ì‚¬í•­</th></tr>
                        <tr><td style="padding:10px 10px; font-size:8pt; line-height:1.6; border:none; vertical-align:top; letter-spacing:-0.5px;">1. ê¸°ìˆ ê²½ë ¥ì„ ì„¤ê³„ ë˜ëŠ” ê±´ì„¤ì‚¬ì—…ê´€ë¦¬ ì‚¬ì—…ìˆ˜í–‰ëŠ¥ë ¥í‰ê°€ì— í™œìš©í•˜ë ¤ëŠ” ê²½ìš° ë°œì£¼ì²­ì´ë‚˜ ì¸ã†í—ˆê°€ê¸°ê´€ ì§ì¸ì˜ ê²½ë ¥í™•ì¸ì„œë¥¼ ì œì¶œí•´ì•¼ í•˜ë©°, ì…ì‚¬ì‹ ê³  ë˜ëŠ” ì¼ë°˜ì ì¸ ê²½ë ¥ì‹ ê³ ëŠ” ì‚¬ìš©ì(ëŒ€í‘œì) ì§ì¸ì˜ ê²½ë ¥í™•ì¸ì„œë¥¼ ì œì¶œí•´ì•¼ í•©ë‹ˆë‹¤.<br>2. â‘³ ì ìš© ìœµã†ë³µí•©ê±´ì„¤ê¸°ìˆ ë€, ã‰‘ ì ìš© ì‹ ê¸°ìˆ  ë“±ë€ ë° ã‰’ ì‹œì„¤ë¬¼ ì¢…ë¥˜ë€ì€ ë°œì£¼ì²­ì´ë‚˜ ì¸ã†í—ˆê°€ê¸°ê´€ì˜ í™•ì¸ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ì¸ì •ë©ë‹ˆë‹¤.<br>3. ê±´ì„¤ê¸°ìˆ ì¸ ë³¸ì¸ì˜ ì„œëª… ë˜ëŠ” ë‚ ì¸ì´ ìˆëŠ” ê²½ìš°ì—ëŠ” ê±´ì„¤ê¸°ìˆ ì¸ ê²½ë ¥ë³€ê²½ì‹ ê³ ì„œ(ã€Œê±´ì„¤ê¸°ìˆ  ì§„í¥ë²• ì‹œí–‰ê·œì¹™ã€ ë³„ì§€ ì œ14í˜¸ì„œì‹ì„ ë§í•©ë‹ˆë‹¤)ë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ë˜ë©°, ì…ã†í‡´ì‚¬ì¼ì„ ì‹ ê³ í•˜ëŠ” ê²½ìš° 4ëŒ€ ë³´í—˜ ìë£Œ ë“± ì¦ëª…í•  ìˆ˜ ìˆëŠ” ì„œë¥˜ë¥¼ ì œì¶œí•´ì•¼ í•©ë‹ˆë‹¤.<br>4. ë‹¤ìˆ˜ì˜ ê²½ë ¥í™•ì¸ì„œë¥¼ ì‘ì„±í•´ì•¼ í•˜ëŠ” ê²½ìš°ì—ëŠ” ê¸°ìˆ ê²½ë ¥ë§Œì„ ì ì€ ì„œë¥˜ë¥¼ ì²¨ë¶€í•˜ì—¬ ì œì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 2ì¥ ì´ìƒì€ ê° ì¥ì— ì‚¬ìš©ì(ëŒ€í‘œì) ë˜ëŠ” ë°œì£¼ìì˜ í™•ì¸(ê°„ì¸ í¬í•¨)ì„ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.<br>5. ì‹ ê³ ì¸(ë³¸ì¸)ì˜ ì„œëª… ë˜ëŠ” ë‚ ì¸ì€ ë³¸ì¸ì´ ì§ì ‘ í•´ì•¼ í•˜ë©° íƒ€ì¸ì´ ì´ë¥¼ ìœ„ì¡°í•˜ëŠ” ê²½ìš° ã€Œí˜•ë²•ã€ ì œ239ì¡°ì— ë”°ë¼ ì²˜ë²Œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</td></tr>
                    </table>
                    <table style="border: 1px solid #000; border-top: 1px solid #000; border-bottom:2px solid #000; margin-top:-1px;">
                        <colgroup><col style="width: 10%;"> <col style="width: 12%;"> <col style="width: 25%;"> <col style="width: 13%;"> <col style="width: 40%;"></colgroup>
                        <tr><th style="background:#fff; height:24px; border-left:none;">ëŒ€ë¦¬ì¸</th><th style="background:#fff;">ì„±ëª…</th><td style="position:relative;"><input type="text" class="center-text"><span style="position:absolute; right:5px; top:5px; color:#aaa; font-size:6pt;">(ì„œëª… ë˜ëŠ” ì¸)</span></td><th style="background:#fff;">ìƒë…„ì›”ì¼</th><td style="border-right:none; padding:0;"><div style="display:flex; height:100%;"><input type="tel" style="width:60%; text-align:center;"><span style="border-left:1px solid #000; border-right:1px solid #000; width:100px; background:#fff; display:flex; align-items:center; justify-content:center; font-size:8pt;">ì—°ë½ì²˜</span><input type="tel" style="flex-grow:1; text-align:center;"></div></td></tr>
                    </table>
                </div>
            </div>
        </div>
    </div><!-- /zoom-container -->
</div><!-- /responsive-wrapper -->

<script>
    /* --- [ì „ì—­ ë³€ìˆ˜] --- */
    let isFormModified = false;

    // ë°˜ì‘í˜• ê¸°ë³¸ ìŠ¤ì¼€ì¼(ë¬¸ì„œë¥¼ í™”ë©´ì— ë§ì¶”ëŠ” ìŠ¤ì¼€ì¼)
    let currentBaseScale = 1;

    // ì»¤ìŠ¤í…€ ì¤Œ ìƒíƒœ(ëª¨ë°”ì¼ ì„¸ë¡œì—ì„œë§Œ ì‚¬ìš©)
    const zoomState = {
        enabled: false,
        userScale: 1,
        minScale: 1,
        maxScale: 3,
        tx: 0,  // screen px ê¸°ì¤€
        ty: 0,  // screen px ê¸°ì¤€
        pointers: new Map(),
        isPinching: false,
        isPanning: false,
        startDist: 0,
        startUserScale: 1,
        startTx: 0,
        startTy: 0,
        startMid: { x: 0, y: 0 },
        lastPan: { x: 0, y: 0 }
    };

    /* --- [ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ] --- */
    window.addEventListener('input', function() { isFormModified = true; });
    window.addEventListener('change', function() { isFormModified = true; });

    // ë¸Œë¼ìš°ì € ë‹«ê¸°/ìƒˆë¡œê³ ì¹¨/ë’¤ë¡œê°€ê¸° ì‹œ ê²½ê³ 
    window.addEventListener('beforeunload', function (e) {
        if (isFormModified) {
            e.preventDefault();
            e.returnValue = 'ì‘ì„± ì¤‘ì¸ ë‚´ìš©ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤.';
        }
    });

    function detectDevice() {
        const ua = navigator.userAgent;
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ua);
        if (isMobile) { document.body.classList.add('mobile-mode'); }
        else { document.body.classList.remove('mobile-mode'); }
        return isMobile;
    }

    /* ------------------------------
       [ì»¤ìŠ¤í…€ ì¤Œ/íŒ¬ ìœ í‹¸]
    ------------------------------ */
    function clamp(v, min, max) { return Math.max(min, Math.min(max, v)); }

    function getDistance(p1, p2) {
        const dx = p2.x - p1.x;
        const dy = p2.y - p1.y;
        return Math.hypot(dx, dy);
    }

    function getMidpoint(p1, p2) {
        return { x: (p1.x + p2.x) / 2, y: (p1.y + p2.y) / 2 };
    }

    function resetZoom() {
        zoomState.userScale = 1;
        zoomState.tx = 0;
        zoomState.ty = 0;
        zoomState.pointers.clear();
        zoomState.isPinching = false;
        zoomState.isPanning = false;
        applyZoomTransform(true);
    }

    // ê²½ê³„ ë³´ì •: í™”ë©´ ë°”ê¹¥ìœ¼ë¡œ ë„ˆë¬´ ë¹ ì§€ì§€ ì•Šê²Œ
    function constrainPan() {
        const wrapper = document.getElementById('responsive-wrapper');
        const zoomEl = document.getElementById('zoom-container');
        if (!wrapper || !zoomEl) return;

        const vw = window.innerWidth;
        const vh = window.innerHeight;

        // í˜„ì¬ transform ë°˜ì˜ í›„ rect ì–»ê¸° ìœ„í•´ í•œë²ˆ ì ìš©
        applyZoomTransform(false);

        const rect = zoomEl.getBoundingClientRect();
        const margin = 10;

        // ì¢Œ/ìš°: rectê°€ í™”ë©´ë³´ë‹¤ ì‘ìœ¼ë©´ ì¤‘ì•™ì— ê°€ê¹Œì´, í¬ë©´ ê°€ì¥ìë¦¬ì—ì„œ ë¹ˆ ê³µê°„ ì—†ê²Œ
        if (rect.width <= vw) {
            const centerOffsetX = (vw - rect.width) / 2 - rect.left;
            zoomState.tx += centerOffsetX;
        } else {
            if (rect.left > margin) zoomState.tx -= (rect.left - margin);
            if (rect.right < vw - margin) zoomState.tx += (vw - margin - rect.right);
        }

        // ìƒ/í•˜:
        if (rect.height <= vh) {
            const centerOffsetY = (vh - rect.height) / 2 - rect.top;
            zoomState.ty += centerOffsetY;
        } else {
            if (rect.top > margin) zoomState.ty -= (rect.top - margin);
            if (rect.bottom < vh - margin) zoomState.ty += (vh - margin - rect.bottom);
        }
    }

    function applyZoomTransform(doConstrain = true) {
        const zoomEl = document.getElementById('zoom-container');
        if (!zoomEl) return;

        const s = zoomState.userScale;

        // baseScaleì´ wrapperì— ê±¸ë ¤ ìˆìœ¼ë¯€ë¡œ,
        // translateëŠ” í™”ë©´ px ê¸°ì¤€ìœ¼ë¡œ ë§ì¶”ê¸° ìœ„í•´ baseScaleë¡œ ë³´ì •
        const tx = zoomState.tx / (currentBaseScale || 1);
        const ty = zoomState.ty / (currentBaseScale || 1);

        zoomEl.style.transform = `translate(${tx}px, ${ty}px) scale(${s})`;

        if (doConstrain && zoomState.enabled) {
            // í•œ ë²ˆ ë” ê²½ê³„ ë³´ì •
            // ë¬´í•œë£¨í”„ ë°©ì§€ ìœ„í•´ constrainPanì—ì„œ applyZoomTransform(false) í˜¸ì¶œí•˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ì§ì ‘ í˜¸ì¶œ X
            // ëŒ€ì‹  constrainPanì„ ì™¸ë¶€ì—ì„œ í˜¸ì¶œ
        }
    }

    function setZoomEnabled(enabled) {
        zoomState.enabled = enabled;
        if (enabled) document.body.classList.add('zoom-enabled');
        else document.body.classList.remove('zoom-enabled');

        // ë¹„í™œì„±í™” ì‹œ ìƒíƒœ ë¦¬ì…‹
        if (!enabled) resetZoom();
    }

    function onPointerDown(e) {
        if (!zoomState.enabled) return;

        const zoomEl = document.getElementById('zoom-container');
        if (!zoomEl) return;

        // ë²„íŠ¼/ì¸í’‹ ìœ„ì—ì„œë„ 2ì†ê°€ë½ í•€ì¹˜ëŠ” ê°€ëŠ¥í•˜ê²Œ ë‘ë˜, 1ì†ê°€ë½ì€ userScale>1ì¼ ë•Œë§Œ íŒ¬ìœ¼ë¡œ ì·¨ê¸‰
        zoomEl.setPointerCapture(e.pointerId);
        zoomState.pointers.set(e.pointerId, { x: e.clientX, y: e.clientY });

        if (zoomState.pointers.size === 2) {
            const pts = Array.from(zoomState.pointers.values());
            zoomState.isPinching = true;
            zoomState.isPanning = false;

            zoomState.startDist = getDistance(pts[0], pts[1]);
            zoomState.startUserScale = zoomState.userScale;
            zoomState.startTx = zoomState.tx;
            zoomState.startTy = zoomState.ty;
            zoomState.startMid = getMidpoint(pts[0], pts[1]);
        } else if (zoomState.pointers.size === 1) {
            // í™•ëŒ€ ìƒíƒœì—ì„œë§Œ íŒ¬ í—ˆìš©(ì›ë˜ í¬ê¸°ì—ì„œëŠ” ë¶ˆí•„ìš”í•˜ê²Œ ì›€ì§ì´ì§€ ì•Šê²Œ)
            if (zoomState.userScale > 1.0001) {
                zoomState.isPanning = true;
                zoomState.isPinching = false;
                zoomState.lastPan = { x: e.clientX, y: e.clientY };
            } else {
                zoomState.isPanning = false;
            }
        }
    }

    function onPointerMove(e) {
        if (!zoomState.enabled) return;
        if (!zoomState.pointers.has(e.pointerId)) return;

        zoomState.pointers.set(e.pointerId, { x: e.clientX, y: e.clientY });

        if (zoomState.isPinching && zoomState.pointers.size === 2) {
            e.preventDefault();

            const pts = Array.from(zoomState.pointers.values());
            const dist = getDistance(pts[0], pts[1]);
            const mid = getMidpoint(pts[0], pts[1]);

            const oldScale = zoomState.userScale;
            const nextScale = clamp(zoomState.startUserScale * (dist / (zoomState.startDist || 1)), zoomState.minScale, zoomState.maxScale);
            zoomState.userScale = nextScale;

            // í•€ì¹˜ ì¤‘ì‹¬ ê³ ì •(í™”ë©´ìƒ midê°€ ê°™ì€ ìœ„ì¹˜ë¥¼ ê°€ë¦¬í‚¤ë„ë¡ tx/ty ì¡°ì •)
            // tx' = mid.x - (mid.x - tx) * (new/old)
            // pinch ì‹œì‘ ì‹œì ì˜ tx/tyë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°
            const ratio = (nextScale / (zoomState.startUserScale || 1));
            zoomState.tx = zoomState.startMid.x - (zoomState.startMid.x - zoomState.startTx) * ratio;
            zoomState.ty = zoomState.startMid.y - (zoomState.startMid.y - zoomState.startTy) * ratio;

            applyZoomTransform(false);
            constrainPan();
            applyZoomTransform(false);
        }
        else if (zoomState.isPanning && zoomState.pointers.size === 1 && zoomState.userScale > 1.0001) {
            e.preventDefault();

            const dx = e.clientX - zoomState.lastPan.x;
            const dy = e.clientY - zoomState.lastPan.y;
            zoomState.lastPan = { x: e.clientX, y: e.clientY };

            zoomState.tx += dx;
            zoomState.ty += dy;

            applyZoomTransform(false);
            constrainPan();
            applyZoomTransform(false);
        }
    }

    function onPointerUp(e) {
        if (!zoomState.enabled) return;

        zoomState.pointers.delete(e.pointerId);

        if (zoomState.pointers.size < 2) {
            zoomState.isPinching = false;
        }
        if (zoomState.pointers.size === 0) {
            zoomState.isPanning = false;

            // ìŠ¤ì¼€ì¼ì´ ê±°ì˜ 1ì´ë©´ ì™„ì „ ë¦¬ì…‹(ë¯¸ì„¸í•œ ì˜¤ì°¨ ì •ë¦¬)
            if (zoomState.userScale < 1.02) {
                resetZoom();
            } else {
                // ëë‚œ í›„ ê²½ê³„ í•œë²ˆ ì •ë¦¬
                applyZoomTransform(false);
                constrainPan();
                applyZoomTransform(false);
            }
        }
    }

    function attachZoomHandlers() {
        const zoomEl = document.getElementById('zoom-container');
        if (!zoomEl) return;

        // ì¤‘ë³µ ë“±ë¡ ë°©ì§€
        if (zoomEl.__zoomHandlersAttached) return;
        zoomEl.__zoomHandlersAttached = true;

        zoomEl.addEventListener('pointerdown', onPointerDown, { passive: false });
        zoomEl.addEventListener('pointermove', onPointerMove, { passive: false });
        zoomEl.addEventListener('pointerup', onPointerUp, { passive: false });
        zoomEl.addEventListener('pointercancel', onPointerUp, { passive: false });
        zoomEl.addEventListener('pointerleave', onPointerUp, { passive: false });
    }

    /* â˜…â˜…â˜… [JS í•µì‹¬] 3ë‹¨ ì™„ì „ ë¶„ë¦¬ + (ëª¨ë°”ì¼ ì„¸ë¡œì—ì„œë§Œ) ì»¤ìŠ¤í…€ Zoom ì œì–´ â˜…â˜…â˜… */
    function resizeForm() {
        const wrapper = document.getElementById('responsive-wrapper');
        const containerWidth = 794;
        const containerHeight = 1123 + 80;

        const isMobile = detectDevice();
        const screenWidth = window.innerWidth;
        const screenHeight = window.innerHeight;
        const isLandscape = screenWidth > screenHeight;

        // [ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”]
        document.body.style.display = '';
        document.body.style.flexDirection = '';
        document.body.style.alignItems = '';
        document.body.style.justifyContent = '';
        document.body.style.overflow = '';
        document.body.style.overflowX = '';
        document.body.style.overflowY = '';
        document.body.style.padding = '';
        document.body.style.margin = '';

        wrapper.style.transformOrigin = '';
        wrapper.style.margin = '';
        wrapper.style.left = '';
        wrapper.style.top = '';
        wrapper.style.height = '';

        // ê¸°ë³¸: meta viewportëŠ” í•­ìƒ ì¤Œ ì ê¸ˆ(ë¸Œë¼ìš°ì € ì¤Œ ì‚¬ìš© X)
        // (ìš”êµ¬ ì¤Œì€ ì»¤ìŠ¤í…€ í•€ì¹˜ë¡œ êµ¬í˜„)
        const viewportMeta = document.getElementById('viewport-meta');
        if (viewportMeta) {
            viewportMeta.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
        }

        /* [Case 1: ëª¨ë°”ì¼ ê°€ë¡œ ëª¨ë“œ (Landscape)] */
        if (isMobile && isLandscape) {
            setZoomEnabled(false); // ê°€ë¡œì—ì„œëŠ” ì»¤ìŠ¤í…€ ì¤Œ OFF + ë¦¬ì…‹

            document.body.style.display = 'block';
            document.body.style.overflowY = 'auto';
            document.body.style.overflowX = 'hidden';
            document.body.style.margin = '0';
            document.body.style.padding = '0';

            const scale = screenWidth / containerWidth;
            currentBaseScale = scale;

            wrapper.style.transform = `scale(${scale})`;
            wrapper.style.transformOrigin = '0 0';
            wrapper.style.margin = '0';

            wrapper.style.height = 'auto';
            document.querySelector('.page-container').style.height = '297mm';

            // ì¤Œ ë ˆì´ì–´ ë³€í™˜ë„ ê¸°ë³¸ê°’ ìœ ì§€
            applyZoomTransform(false);
        }

        /* [Case 2: ëª¨ë°”ì¼ ì„¸ë¡œ ëª¨ë“œ (Portrait)] - ì»¤ìŠ¤í…€ ì¤Œ ON */
        else if (isMobile && !isLandscape) {
            setZoomEnabled(true);
            attachZoomHandlers();

            document.body.style.display = 'flex';
            document.body.style.flexDirection = 'column';
            document.body.style.alignItems = 'center';
            document.body.style.justifyContent = 'center';
            document.body.style.overflow = 'hidden';

            const padding = 10;
            const availableWidth = screenWidth - padding;
            const availableHeight = screenHeight;

            const scaleX = availableWidth / containerWidth;
            const scaleY = availableHeight / containerHeight;
            const scale = Math.min(scaleX, scaleY);

            currentBaseScale = scale;

            wrapper.style.transform = `scale(${scale})`;
            wrapper.style.transformOrigin = 'top center';

            const heightDiff = containerHeight * (1 - scale);
            wrapper.style.marginBottom = `-${heightDiff}px`;

            // íšŒì „/ë¦¬ì‚¬ì´ì¦ˆ ì‹œ "ì´ˆê¸°ê°’ ë³µêµ¬" ìš”êµ¬: ì„¸ë¡œ ì§„ì… ì‹œ í•­ìƒ ë¦¬ì…‹
            resetZoom();
        }

        /* [Case 3: PC ëª¨ë“œ] */
        else {
            setZoomEnabled(false); // PCëŠ” ì»¤ìŠ¤í…€ ì¤Œ OFF

            document.body.style.display = 'flex';
            document.body.style.flexDirection = 'column';
            document.body.style.alignItems = 'center';
            document.body.style.justifyContent = 'center';
            document.body.style.overflow = 'hidden';

            const padding = 20;
            const availableWidth = screenWidth - padding;
            const availableHeight = screenHeight - padding;

            const scaleX = availableWidth / containerWidth;
            const scaleY = availableHeight / containerHeight;
            const scale = Math.min(scaleX, scaleY);

            currentBaseScale = scale;

            wrapper.style.transform = `scale(${scale})`;
            wrapper.style.transformOrigin = 'top center';

            const heightDiff = containerHeight * (1 - scale);
            wrapper.style.marginBottom = `-${heightDiff}px`;

            applyZoomTransform(false);
        }
    }

    window.addEventListener("resize", resizeForm);
    window.addEventListener("orientationchange", function() {
        // iOSì—ì„œ orientationchange ì§í›„ innerHeightê°€ ì ê¹ ì´ìƒí•´ì ¸ì„œ ì•½ê°„ ë”œë ˆì´
        setTimeout(resizeForm, 250);
    });

    function toggleCalcPanel() {
        const panel = document.getElementById('calcPanel');
        if (panel.style.display === 'flex') { panel.style.display = 'none'; }
        else { panel.style.display = 'flex'; panel.classList.add('show'); }
    }

    function autoFitText(el) {
        el.style.letterSpacing = 'normal';
        let hiddenSpan = document.getElementById('text-measure-span');
        if (!hiddenSpan) {
            hiddenSpan = document.createElement('span'); hiddenSpan.id = 'text-measure-span';
            hiddenSpan.style.visibility = 'hidden'; hiddenSpan.style.position = 'absolute'; hiddenSpan.style.whiteSpace = 'nowrap';
            document.body.appendChild(hiddenSpan);
        }
        const computed = window.getComputedStyle(el);
        hiddenSpan.style.font = computed.font; hiddenSpan.style.fontSize = computed.fontSize;
        hiddenSpan.style.fontFamily = computed.fontFamily; hiddenSpan.style.fontWeight = computed.fontWeight;
        hiddenSpan.innerText = el.value;
        const textWidth = hiddenSpan.getBoundingClientRect().width;
        const availableWidth = el.clientWidth;
        if (textWidth > availableWidth) {
            const length = el.value.length;
            if (length > 1) {
                const overflow = textWidth - availableWidth;
                let spacing = -1 * (overflow / (length - 1)) - 0.5;
                if (spacing < -3) spacing = -3;
                el.style.letterSpacing = spacing + 'px';
            }
        } else { el.style.letterSpacing = 'normal'; }
    }

    async function saveToFile() {
        const data = {};
        document.querySelectorAll('input, select').forEach(el => {
            if (el.id) { if(el.type === 'checkbox') data[el.id] = el.checked; else data[el.id] = el.value; }
        });
        const jsonStr = JSON.stringify(data, null, 2);
        const fileName = 'ê¸°ê³„ì„¤ë¹„ ìœ ì§€ê´€ë¦¬ì_ê²½ë ¥í™•ì¸ì„œ_ë°ì´í„°.json';
        if (window.showSaveFilePicker) {
            try {
                const handle = await window.showSaveFilePicker({ suggestedName: fileName, types: [{ description: 'JSON Files', accept: { 'application/json': ['.json'] } }] });
                const writable = await handle.createWritable(); await writable.write(jsonStr); await writable.close();
                alert('íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                isFormModified = false;
                return;
            } catch (err) { if (err.name === 'AbortError') return; console.error(err); }
        }
        const blob = new Blob([jsonStr], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = fileName;
        document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);
        alert('íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
        isFormModified = false;
    }

    function triggerFileLoad() { document.getElementById('file_input').click(); }
    function loadFromFile(input) {
        const file = input.files[0]; if (!file) return;
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const data = JSON.parse(e.target.result);
                for (const [id, val] of Object.entries(data)) {
                    const el = document.getElementById(id);
                    if(el) {
                        if(el.type === 'checkbox') el.checked = val;
                        else { el.value = val; if(id === 'user_addr' || id === 'comp_name' || id === 'comp_addr') autoFitText(el); }
                        if(el.tagName === 'SELECT') checkSelectPlaceholder(el);
                    }
                }
                if(document.getElementById('chk_working').checked) toggleRetireDate();
                updateSpecialty(1); updateSpecialty(2);
                const status = checkEntry1();
                if(status.allFilled) {
                    if(data['task1']) updateResponsibility(1); if(data['task2']) updateResponsibility(2);
                    if(data['spec1']) document.getElementById('spec1').value = data['spec1'];
                    if(data['resp1']) document.getElementById('resp1').value = data['resp1'];
                    if(data['spec2']) document.getElementById('spec2').value = data['spec2'];
                    if(data['resp2']) document.getElementById('resp2').value = data['resp2'];
                    if(document.getElementById('spec1')) checkSelectPlaceholder(document.getElementById('spec1'));
                    if(document.getElementById('spec2')) checkSelectPlaceholder(document.getElementById('spec2'));
                }
                updateDayCalculations(); alert("íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
                isFormModified = false;
            } catch (err) { alert("íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."); }
        };
        reader.readAsText(file); input.value = '';
    }

    function formatNumber(target, type) {
        let val = target.value.replace(/[^0-9]/g, ''); let result = val;
        if(type === 'money' && val) result = Number(val).toLocaleString();
        else if(type === 'phone' && val.length > 3) result = val.substr(0,3)+'-'+val.substr(3,4)+'-'+val.substr(7);
        else if(type === 'id') { if(val.length > 13) val = val.substr(0, 13); if(val.length > 6) result = val.substr(0,6) + '-' + val.substr(6); else result = val; }
        else if(type === 'biz' && val.length > 3) result = val.substr(0,3)+'-'+val.substr(3,2)+'-'+val.substr(5);
        target.value = result;
    }
    function formatCompPhone(target) {
        let val = target.value.replace(/[^0-9]/g, ''); if(val.length > 12) val = val.substr(0, 12); target.value = val;
    }

    function showTooltip(input) {
        if(input.disabled) return;
        const tooltipId = 'tooltip_' + input.id; const tooltip = document.getElementById(tooltipId);
        if(tooltip) tooltip.classList.add('show');
    }
    function hideTooltip(input) {
        const tooltipId = 'tooltip_' + input.id; const tooltip = document.getElementById(tooltipId);
        if(tooltip) tooltip.classList.remove('show');
    }

    const jobData = { "ê¸°ê³„": ["ê³µì¡°ëƒ‰ë™ ë° ì„¤ë¹„", "ìš©ì ‘"] };
    function initAllFields() {
        detectDevice();

        const taskSelects = [document.getElementById('task1'), document.getElementById('task2')];
        const taskOptions = ["ìœ ì§€ê´€ë¦¬", "ìœ ì§€ë³´ìˆ˜ë°ë³´ê°•"];
        taskSelects.forEach(select => {
            if(select) {
                taskOptions.forEach(key => { let option = document.createElement("option"); option.value = key; option.text = key; select.appendChild(option); });
            }
        });

        updateSpecialty(1); updateSpecialty(2);

        const allSelects = document.querySelectorAll('select');
        allSelects.forEach(el => checkSelectPlaceholder(el));

        checkEntry1();
        resizeForm();

        // --- [ì¶”ê°€ëœ í¬ì»¤ìŠ¤ ì‹œê°í™” ê¸°ëŠ¥ (ì˜¬ë°”ë¥¸ ìœ„ì¹˜)] ---
        document.querySelectorAll('input, select, textarea').forEach(el => {
            el.addEventListener('focus', function() {
                this.classList.add('focus-ring-active');
            });
            el.addEventListener('blur', function() {
                this.classList.remove('focus-ring-active');
            });
        });
    }

    function checkSelectPlaceholder(el) {
        if (!el.value) el.classList.add('empty-value'); else el.classList.remove('empty-value');
    }
    function updateSpecialty(idx) {
        const specSelect = document.getElementById('spec' + idx);
        const selectedJob = "ê¸°ê³„"; specSelect.innerHTML = '<option value="">ì„ íƒ</option>';
        if (selectedJob && jobData[selectedJob]) {
            jobData[selectedJob].forEach(spec => { let option = document.createElement("option"); option.value = spec; option.text = spec; specSelect.appendChild(option); });
        }
        checkSelectPlaceholder(specSelect);
    }
    function updateResponsibility(idx) { return; }

    function toggleRetireDate() {
        const chk = document.getElementById('chk_working'); const dateInput = document.getElementById('retire_date'); const textDiv = document.getElementById('retire_text');
        if (chk.checked) { dateInput.style.display = 'none'; textDiv.style.display = 'block'; dateInput.value = ''; }
        else { dateInput.style.display = 'block'; textDiv.style.display = 'none'; }
        validateAllDates(1); validateAllDates(2);
    }

    function calculateDays(startDateStr, endDateStr) {
        if(!startDateStr || !endDateStr) return 0;
        const start = new Date(startDateStr); const end = new Date(endDateStr);
        if (start > end) return 0;
        const diffTime = Math.abs(end - start);
        return Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
    }
    function updateDayCalculations() {
        const s1 = document.getElementById('part_start_1').value; const e1 = document.getElementById('part_end_1').value;
        const days1 = calculateDays(s1, e1); document.getElementById('panel_days_1').innerText = days1;
        const s2 = document.getElementById('part_start_2').value; const e2 = document.getElementById('part_end_2').value;
        const days2 = calculateDays(s2, e2); document.getElementById('panel_days_2').innerText = days2;
    }

    function validateAllDates(idx) {
        const joinDateEl = document.getElementById('join_date'); const retireDateEl = document.getElementById('retire_date');
        const isWorking = document.getElementById('chk_working').checked;

        if(!joinDateEl.value) joinDateEl.classList.add('required-missing'); else joinDateEl.classList.remove('required-missing');
        if(!isWorking && !retireDateEl.value) retireDateEl.classList.add('required-missing'); else retireDateEl.classList.remove('required-missing');

        const joinDate = joinDateEl.value; const retireDate = retireDateEl.value;
        if (!isWorking && joinDate && retireDate && joinDate > retireDate) {
            alert("ì…ì‚¬ì¼/í‡´ì‚¬ì¼: í‡´ì‚¬ì¼ì´ ì…ì‚¬ì¼ë³´ë‹¤ ì•ì„¤ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            document.getElementById('retire_date').value = "";
            return;
        }

        const partStartEl = document.getElementById('part_start_' + idx); const partEndEl = document.getElementById('part_end_' + idx);
        if (!partStartEl || !partEndEl) return;

        const partStart = partStartEl.value; const partEnd = partEndEl.value;

        if (partStart && partEnd && partStart > partEnd) { alert("ì°¸ì—¬ê¸°ê°„: ì¢…ë£Œì¼ì´ ì‹œì‘ì¼ë³´ë‹¤ ì•ì„¤ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); partEndEl.value = ""; updateDayCalculations(); return; }
        if (partStart && joinDate && partStart < joinDate) { alert(`ì°¸ì—¬ê¸°ê°„ ì‹œì‘ì¼(${partStart})ì€ ì…ì‚¬ì¼(${joinDate})ë³´ë‹¤ ë¹ ë¥¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`); partStartEl.value = ""; return; }
        if (partEnd) { if (!isWorking && retireDate && partEnd > retireDate) { alert(`ì°¸ì—¬ê¸°ê°„ ì¢…ë£Œì¼(${partEnd})ì€ í‡´ì‚¬ì¼(${retireDate})ë³´ë‹¤ ëŠ¦ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`); partEndEl.value = ""; updateDayCalculations(); return; } }

        checkOverlap(); updateDayCalculations();
    }

    function checkOverlap() {
        const s1 = document.getElementById('part_start_1').value; const e1 = document.getElementById('part_end_1').value;
        const s2 = document.getElementById('part_start_2').value; const e2 = document.getElementById('part_end_2').value;
        if (s1 && e1 && s2 && e2) {
            if (s1 <= e2 && e1 >= s2) {
                alert("ì˜¤ë¥˜: ì—°ë²ˆ1ê³¼ ì—°ë²ˆ2ì˜ ì°¸ì—¬ê¸°ê°„ì€ ê²¹ì¹  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\në‚ ì§œë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.");
                document.getElementById('part_start_2').value = "";
                document.getElementById('part_end_2').value = "";
                updateDayCalculations();
            }
        }
    }

    function checkHeadquarters(idx) {
        const pName = document.getElementById('proj_name_' + idx); const spec = document.getElementById('spec' + idx);
        if (!pName || !spec) return;
        if (pName.value.trim() === 'ë³¸ì‚¬') { spec.innerHTML = '<option value=""></option>'; spec.disabled = true; checkSelectPlaceholder(spec); }
        else { if (!pName.disabled) { spec.disabled = false; if (spec.options.length === 1 && spec.options[0].text === "") updateSpecialty(idx); } }
    }

    function checkEntry2() {
        const requiredFields2 = document.querySelectorAll('.e2-req');
        requiredFields2.forEach(el => {
            if (!el.disabled) {
                if (!el.value.trim()) el.classList.add('required-missing'); else el.classList.remove('required-missing');
            } else {
                el.classList.remove('required-missing');
            }
        });
    }

    function checkEntry1() {
        const requiredFields1 = document.querySelectorAll('.e1-req');
        let allFilled = true; let isCompletelyEmpty = true;
        requiredFields1.forEach(el => {
            if (el.value.trim()) { isCompletelyEmpty = false; el.classList.remove('required-missing'); }
            else { allFilled = false; el.classList.add('required-missing'); }
        });

        const entry2Rows = document.querySelectorAll('.entry2-row'); const entry2Inputs = document.querySelectorAll('.e2-all');
        const alertMsg = "ì—°ë²ˆ1ì˜ í•„ìˆ˜ê°’(ì°¸ì—¬ê¸°ê°„, ì‚¬ì—…ëª…, ì§ë¬´ë¶„ì•¼, ì „ë¬¸ë¶„ì•¼, ë‹´ë‹¹ì—…ë¬´, ì§ìœ„)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.";

        if (allFilled) {
            entry2Inputs.forEach(el => el.disabled = false);
            entry2Rows.forEach(row => row.removeAttribute('title'));
            const tooltip2 = document.getElementById('tooltip_proj_name_2'); if(tooltip2) tooltip2.style.display = 'block';
            checkHeadquarters(2); checkEntry2();
        } else {
            entry2Inputs.forEach(el => { el.disabled = true; el.value = ""; el.classList.remove('required-missing'); if(el.tagName === 'SELECT') checkSelectPlaceholder(el); });
            entry2Rows.forEach(row => row.setAttribute('title', alertMsg));
            const tooltip2 = document.getElementById('tooltip_proj_name_2'); if(tooltip2) tooltip2.style.display = 'none';
            updateDayCalculations();
        }
        return { allFilled, isCompletelyEmpty };
    }

    function validateAndPrint() {
        const isMobile = detectDevice();
        if (isMobile) { alert("PCì—ì„œ ì¶œë ¥í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤."); return; }

        const status1 = checkEntry1();

        if (status1.isCompletelyEmpty) { window.print(); return; }

        const highlightError = (element) => {
            element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            element.focus();
            element.classList.add('shake-effect');
            setTimeout(() => { element.classList.remove('shake-effect'); }, 400);
        };

        if (!status1.allFilled) {
            alert("ì—°ë²ˆ1ì˜ í•„ìˆ˜ê°’(ì°¸ì—¬ê¸°ê°„, ì‚¬ì—…ëª…, ì§ë¬´ë¶„ì•¼, ì „ë¬¸ë¶„ì•¼, ë‹´ë‹¹ì—…ë¬´, ì§ìœ„)ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            const missingEl = document.querySelector('.e1-req.required-missing');
            if (missingEl) { highlightError(missingEl); }
            return;
        }

        const entry2InputsAll = document.querySelectorAll('.e2-all');
        let isEntry2Started = false;
        entry2InputsAll.forEach(el => { if (el.value.trim()) isEntry2Started = true; });

        if (isEntry2Started) {
            const requiredFields2 = document.querySelectorAll('.e2-req');
            let allFilled2 = true;
            requiredFields2.forEach(el => {
                if (!el.value.trim()) { allFilled2 = false; el.classList.add('required-missing'); }
                else { el.classList.remove('required-missing'); }
            });

            if (!allFilled2) {
                alert("ì—°ë²ˆ2ë¥¼ ì‘ì„± ì¤‘ì…ë‹ˆë‹¤. í•„ìˆ˜ê°’ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.\n(ì…ë ¥í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ì—°ë²ˆ2 ë‚´ìš©ì„ ëª¨ë‘ ì§€ì›Œì£¼ì„¸ìš”)");
                const missingEl2 = document.querySelector('.e2-req.required-missing');
                if (missingEl2) { highlightError(missingEl2); }
                return;
            }
        }

        window.print();
    }
</script>
</body>
</html>
